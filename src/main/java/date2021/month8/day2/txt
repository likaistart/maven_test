CREATE TABLE `b2c_order` (
	`id` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT BY GROUP COMMENT '自增id',
	`order_no` varchar(30) NOT NULL DEFAULT '' COMMENT '订单号',
	`itemcate_id` int(11) NOT NULL DEFAULT '0' COMMENT '主类目id',
	`price_type` tinyint(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT '订单类型:1=一口价2=竞价',
	`service_type` tinyint(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT '服务类型:1=安装2=测量3=维修4=送货到楼下5=送货到家6=送货到家并安装',
	`customer` varchar(50) NOT NULL DEFAULT '' COMMENT '客户名称',
	`cellphone` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '客户手机',
	`user_id` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '商户id',
	`creator_id` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '操作者id',
	`user_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '商户联系人',
	`user_cellphone` varchar(20) DEFAULT '' COMMENT '商户手机',
	`user_remarks` varchar(255) DEFAULT '' COMMENT '商户服务备注',
	`expect_date` datetime DEFAULT NULL COMMENT '期望上门时间,默认null不限制',
	`expect_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '期望报价',
	`base_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '基础费用总额(安装)',
	`added_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '附加(安装要求)费用总额',
	`discount_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '优惠金额',
	`reduced_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '折扣金额(公司不补贴，不走结算逻辑)',
	`price` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '订单金额',
	`insurance_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '商品保费总额',
	`pay_price` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '实付金额',
	`add_price` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '增加费用总额',
	`commission` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '平台收佣金额',
	`worker_price` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '师傅价格',
	`worker_insurance` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '工人保险金额',
	`settlement` decimal(10, 2) UNSIGNED NOT NULL DEFAULT '0.00' COMMENT '结算金额',
	`refund_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '退款总额',
	`user_refund_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '商家退款总额',
	`com_refund_price` decimal(10, 2) UNSIGNED DEFAULT '0.00' COMMENT '公司退款总额',
	`province` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '省',
	`city` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '市',
	`area` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '区县',
	`town` int(11) UNSIGNED DEFAULT '0' COMMENT '街道乡镇',
	`location` varchar(100) DEFAULT '' COMMENT '高德坐标',
	`address` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '地址',
	`arrival_state` tinyint(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT '到货状态0无1已到客户家2未到客户家',
	`arrival_time` datetime DEFAULT NULL COMMENT '预计到货时间',
	`third_party_order` varchar(50) DEFAULT '' COMMENT '第三方平台订单号',
	`status` tinyint(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT '订单状态,默认0无效2待报价3待雇佣5待支付10待抢单15待预约17待提货20待上门25待核销30待验收35交易完成50关闭',
	`is_comment` tinyint(1) UNSIGNED NOT NULL DEFAULT '0' COMMENT '评论0无1待评价2已评论',
	`hangup_times` tinyint(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT '挂起0无1有挂起2次..',
	`worker_id` int(11) UNSIGNED DEFAULT '0' COMMENT '工人id',
	`appointment_btime` datetime DEFAULT NULL COMMENT '预约上门start时间/需要预约start时间',
	`appointment_time` datetime DEFAULT NULL COMMENT '预约上门end时间/需要预约end时间',
	`pay_type` smallint(5) UNSIGNED DEFAULT '0' COMMENT '付款方式1支付宝2微信3电子钱包4钱包虚拟金额',
	`hire_time` datetime DEFAULT NULL COMMENT '达成雇佣时间',
	`offer_time` datetime DEFAULT NULL COMMENT '首次报价时间',
	`complete_time` datetime DEFAULT NULL COMMENT '完工时间',
	`closure_time` datetime DEFAULT NULL COMMENT '验收完成/关闭时间',
	`created_at` datetime NOT NULL COMMENT '创建时间',
	`updated_at` datetime DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
	`channel` tinyint(1) NOT NULL DEFAULT '0' COMMENT '渠道1商家端2小程序3h5',
	`task_no` varchar(30) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '批量导单任务号',
	`compensation` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否先行赔付 0. 否 1.是',
	PRIMARY KEY (`id`),
	UNIQUE KEY `idx_order_no` USING BTREE (`order_no`) COMMENT '订单id',
	KEY `auto_shard_key_user_id` USING BTREE (`user_id`),
	KEY `idx_appointment_time` USING BTREE (`appointment_time`) COMMENT '预约相关时间',
	KEY `idx_status` USING BTREE (`status`) COMMENT '订单状态',
	KEY `auto_shard_key_created_at` (`created_at`),
	GLOBAL INDEX `g_i_order_cellphone`(`cellphone`) COVERING (`id`, `user_id`, `created_at`) DBPARTITION BY HASH(`cellphone`) TBPARTITION BY HASH(`cellphone`) TBPARTITIONS 8,
	GLOBAL INDEX `g_i_order_order_no`(`order_no`) COVERING (`id`, `user_id`, `created_at`) DBPARTITION BY HASH(`order_no`) TBPARTITION BY HASH(`order_no`) TBPARTITIONS 8,
	GLOBAL INDEX `g_i_order_worker_id`(`worker_id`) COVERING (`id`, `customer`, `cellphone`, `user_id`, `created_at`) DBPARTITION BY HASH(`worker_id`) TBPARTITION BY HASH(`worker_id`) TBPARTITIONS 8
) ENGINE = InnoDB AUTO_INCREMENT = 1004033 DEFAULT CHARSET = utf8 COMMENT '订单'  dbpartition by hash(`user_id`) tbpartition by YYYYMM(`created_at`) tbpartitions 8;